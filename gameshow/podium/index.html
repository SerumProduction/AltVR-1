<!DOCTYPE html>
<html>
<head>
	<title>GameShow Test</title>
	<script src="https://aframe.io/releases/0.7.0/aframe.js"></script>
	<script src="https://sdk.altvr.com/libs/altspace.js/2.8.2/altspace.min.js"></script>
</head>
<body>
	<a-scene altspace='verticalAlign: bottom'>
		<a-entity id='oldPodium' position='1 0 1' rotation='0 0 0'>
			<a-box position='0 .6 0' scale='.5 1.2 .5' color='#666'></a-box>
			<a-box position='0 1.2 0' scale='.6 .2 .6' rotation='-20 0 0' color='#555'></a-box>
			<a-box position='0 .93 .26' scale='.4 .4 .02' color='#fff'></a-box>
			<a-cylinder position='0 1.28 -.04' scale='.07 .1 .07' rotation='-20 0 0' color='#b00'></a-cylinder>

			<a-entity position='0 .93 .29' n-text='fontSize: 3; text: <color=black>1'></a-entity>
			<a-entity position='0 1.3 .3' rotation='-20 0 0' n-text='fontSize: 1; text: Player 1'></a-entity>
		</a-entity>

		<a-entity id='newPodium' position='0 0 1' rotation='0 -90 05' scale='.5 .55 .5' obj-model='obj: url(podium.obj); mtl: url(podium2.mtl)'></a-entity>
		<a-cylinder position='0 1.24 .90' rotation='-25 0 0' scale='.07 .1 .07' color='#b00'></a-cylinder>
		<!-- <a-box position='0 1 1.14' scale='.32 .32 .03'></a-box> -->
		<!-- <a-entity position='0 1 1.16' n-text='fontSize: 3; text: <color=black>1'></a-entity> -->


		<a-entity id='podium1' position='-1.6 0 -2' rotation='0 -90 0' scale='.5 .5 .5' obj-model='obj: url(podium.obj); mtl: url(podium2.mtl)'></a-entity>
		<a-cylinder position='-1.6 1.13 -2' rotation='-20 0 0' scale='.07 .1 .07' color='red'></a-cylinder>

		<a-entity id='podium2' position='-.8 0 -2' rotation='0 -90 0' scale='.5 .5 .5' obj-model='obj: url(podium.obj); mtl: url(podium2.mtl)'></a-entity>
		<a-cylinder position='-.8 1.13 -2' rotation='-20 0 0' scale='.07 .1 .07' color='red'></a-cylinder>

		<a-entity id='podium3' position='0 0 -2' rotation='0 -90 0' scale='.5 .5 .5' obj-model='obj: url(podium.obj); mtl: url(podium2.mtl)'></a-entity>
		<a-cylinder position='0 1.13 -2' rotation='-20 0 0' scale='.07 .1 .07' color='red'></a-cylinder>

		<a-entity id='podium4' position='.8 0 -2' rotation='0 -90 0' scale='.5 .5 .5' obj-model='obj: url(podium.obj); mtl: url(podium2.mtl)'></a-entity>
		<a-cylinder position='.8 1.13 -2' rotation='-20 0 0' scale='.07 .1 .07' color='red'></a-cylinder>

		<a-entity id='podium5' position='1.6 0 -2' rotation='0 -90 0' scale='.5 .5 .5' obj-model='obj: url(podium.obj); mtl: url(podium2.mtl)'></a-entity>
		<a-cylinder position='1.6 1.13 -2' rotation='-20 0 0' scale='.07 .1 .07' color='red'></a-cylinder>

		<a-box id='button1' position='-.35 0 2' scale='.2 .2 .2'></a-box>
		<a-box id='button2' position='0 0 1.85' scale='.2 .2 .2' color='green'></a-box>
		<a-box id='button3' position='0 0 2.15' scale='.2 .2 .2' color='red'></a-box>
		<a-box id='button4' position='.35 0 2' scale='.2 .2 .2' color='black'></a-box>

		<!-- <a-cone position='0 1.5 .5' scale='.5 3 .5' rotation='45 0 0' opacity='.1'></a-cone> -->
		
	</a-scene>
<script>
	 var scene = document.querySelector('a-scene');
   //scene.addEventListener('connected', function() {
 //  	var sync = scene.systems['sync-system'].connection;

  	var stripes;
		newPodium.addEventListener('model-loaded', function(){
			console.log('loaded');

			var currentState = 'black'

			stripes = newPodium.object3D.children[0].getObjectByName('stripes');


			//setColor('green');
	  	function setColor(c) {
	  		switch (c) {
	  			case 'black':
	  				stripes.material.map.offset.set(0,0);
	  				break;
	  			case 'white':
	  				stripes.material.map.offset.set(.2,0);
	  				break;
	  			case 'green':
	  				stripes.material.map.offset.set(.2,-.5);
	  				break;
	  			case 'red':
	  				stripes.material.map.offset.set(.4,-.5);
	  				break;
	  		}
	  	}

			var dur = 500;

			//stripes.material.map.offset.x = .2;
			button1.addEventListener('mouseup', function(){
				if (currentState == 'black') {
					stripes.material.map.offset.x = 0;
					stripes.material.map.offset.y = 0;
					new TWEEN.Tween(stripes.material.map.offset).to({y: -.5}, dur).start();

					currentState = 'white';
				}
			});
			button2.addEventListener('mouseup', function(){
				if (currentState == 'white') {
					stripes.material.map.offset.x = .2;
					stripes.material.map.offset.y = 0;
					new TWEEN.Tween(stripes.material.map.offset).to({y: -.5}, dur).start();

					currentState = 'green';
				}
			});
			button3.addEventListener('mouseup', function(){
				if (currentState == 'white') {
					stripes.material.map.offset.x = .4;
					stripes.material.map.offset.y = 0;
					new TWEEN.Tween(stripes.material.map.offset).to({y: -.5}, dur).start();

					currentState = 'red';
				}
			});

			button4.addEventListener('mouseup', function(){
				if (currentState == 'white') {
					stripes.material.map.offset.x = 0;
					stripes.material.map.offset.y = -.5;
					new TWEEN.Tween(stripes.material.map.offset).to({y: 0}, dur).start();

					currentState = 'black';
				}

				if (currentState == 'green') {
					stripes.material.map.offset.x = .6;
					stripes.material.map.offset.y = -.5;
					new TWEEN.Tween(stripes.material.map.offset).to({y: 0}, dur).start();

					currentState = 'black';
				}

				if (currentState == 'red') {
					stripes.material.map.offset.x = .8;
					stripes.material.map.offset.y = -.5;
					new TWEEN.Tween(stripes.material.map.offset).to({y: 0}, dur).start();

					currentState = 'black';
				}
			});
		});

		// var previousState;
  // 	sync.instance.child('color').on('value', function(data){
  // 		console.log('yes');
  // 		if (data.val() != null) {
	 //  		if (previousState == undefined) {
	 //  			console.log('set to ' + data.val());
	 //  			//setColor(data.val());
	 //  		} else {
		//   		console.log(previousState + ' to ' + data.val());
		//   	}
	 //  		previousState = data.val();
	 //  	}
  // 	});

  // 	//setColor('red');
  // 	function setColor(c) {
  // 		switch (c) {
  // 			case 'black':
  // 				stripes.material.map.offset.set(0,0);
  // 				break;
  // 			case 'white':
  // 				stripes.material.map.offset.set(.2,0);
  // 				break;
  // 			case 'green':
  // 				stripes.material.map.offset.set(.2,-.5);
  // 				break;
  // 			case 'red':
  // 				stripes.material.map.offset.set(.4,-.5);
  // 				break;
  // 		}
  // 	}

  // 	function animateColor(c, c2) {

  // 	}
  //});
</script>
</body>
</html>