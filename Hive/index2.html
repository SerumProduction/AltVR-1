<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Hive Stage</title>
  <script src="https://aframe.io/releases/0.3.0/aframe.js"></script>
  <script src="https://sdk.altvr.com/libs/altspace.js/2.4.0/altspace.js"></script>
</head>
<body>
<a-scene altspace='fullspace: true' sync-system='author: BenG; app: Hive; refUrl: https://altvr-apps.firebaseio.com/'>
  
  <img id='badgehex' src='https://bengarfield.github.io/AltVR/Hive/beebadge.png'>
  <img id='logo' src='https://bengarfield.github.io/AltVR/Hive/logo.png'>
  
  <a-mixin id='hexBadge' geometry='primitive: plane' material='src: #badgehex; transparent: true' position='-.1 .35 -.15' rotation='0 180 0' scale='.1 .1 .1' n-skeleton-parent='part: spine' sync sync-n-skeleton-parent></a-mixin>
  <a-entity one-per-user="mixin: hexBadge"></a-entity>
  
  <!-- <a-sky radius='50' rotation='0 -90 0' src='https://i.imgur.com/GzUK93g.jpg' color='#fff'></a-sky> -->
  
  <!-- <a-circle position='0 .01 0' rotation='-90 0 0' scale='3.7 3.7 1' color='#009' opacity='.1' altspace-cursor-collider='enabled: false'></a-circle> -->
  <a-circle position='0 .01 0' rotation='-90 0 0' scale='3.7 3.7 1' color='#fdc607' opacity='.3' altspace-cursor-collider='enabled: false'></a-circle>
  
  <a-box id='rant' position='8 -1000 -3' scale='5 .001 1' n-box-collider='type: environment; convex: false' color='#aaf' opacity='0.1'></a-box>
  
  <!-- <a-entity id='bdropPos' position='0 0 5' rotation='0 0 0'>
    <a-entity position='0 2 -10' scale='2.5 2.5 1'>
      <a-plane id='backdrop' scale='3.725 1.996 1' rotation='0 0 0' src='https://bengarfield.github.io/AltVR/Hive/poxxxx.png' transparent='true' color='#fff'>
        <a-animation attribute='material.color' from='#fff' to='#777' dur='1000' begin='darken'></a-animation>
        <a-animation attribute='material.color' from='#777' to='#fff' dur='1000' begin='lighten'></a-animation>
      </a-plane>
    </a-entity>
    <a-animation to='0 -60 0' dur='10000' begin='off'></a-animation>
    <a-animation from='0 -60 0' to='0 0 0' dur='10000' begin='on'></a-animation>
  </a-entity> -->
  
  <a-entity id='sound'></a-entity>
  <a-entity id='sound2' sync sync-n-sound></a-entity>
  <a-entity id='sound3' sync sync-n-sound></a-entity>
  <a-entity id='syncDing' sync sync-n-sound></a-entity>
  <a-entity id='syncLaugh' sync sync-n-sound></a-entity>
  
  <!-- <a-entity id='podiums' position='-2.5 0 -1.5' rotation='0 45 0'>
    <a-animation attribute='position' to='-2.5 1.5 -1.5' dur='5000' begin='raise'></a-animation>
    <a-animation attribute='position' from='-2.5 1.5 -1.5' to='-2.5 0 -1.5' dur='5000' begin='lower'></a-animation>
  
    <a-entity position='-.8 0 0'>
      <a-entity id='podiumobj1' position='0 -1.5 0' scale='.5 .5 .5' rotation='0 -90 0' obj-model='obj: url(https://bengarfield.github.io/AltVR/Hive/podium.obj); mtl: url(https://bengarfield.github.io/AltVR/Hive/podium.mtl)'></a-entity>
      <a-cylinder id='button1' position='0 -.26 0' scale='.05 .04 .05' color='red'></a-cylinder>
      
      <a-entity id='p1nametext' position='0 -.255 .262' scale='.9 .9 .9' n-text='fontSize: 1; text: <color=black>Player1'></a-entity>
      <a-entity id='p1text' position='.01 -.51 .272' n-text='fontSize: 2; text: <color=black>1'></a-entity>
    </a-entity>
    
    <a-entity position='0 0 0'>
      <a-entity id='podiumobj2' position='0 -1.5 0' scale='.5 .5 .5' rotation='0 -90 0' obj-model='obj: url(https://bengarfield.github.io/AltVR/Hive/podium.obj); mtl: url(https://bengarfield.github.io/AltVR/Hive/podium2.mtl)'></a-entity>
      <a-cylinder id='button2' position='0 -.26 0' scale='.05 .04 .05' color='red'></a-cylinder>
      
      <a-entity id='p2nametext' position='0 -.255 .262' scale='.9 .9 .9' n-text='fontSize: 1; text: <color=black>Player2'></a-entity>
      <a-entity id='p2text' position='.01 -.51 .272' n-text='fontSize: 2; text: <color=white>2'></a-entity>
    </a-entity>
    
    <a-entity position='.8 0 0'>
      <a-entity id='podiumobj3' position='0 -1.5 0' scale='.5 .5 .5' rotation='0 -90 0' obj-model='obj: url(https://bengarfield.github.io/AltVR/Hive/podium.obj); mtl: url(https://bengarfield.github.io/AltVR/Hive/podium2.mtl)'></a-entity>
      <a-cylinder id='button3' position='0 -.26 0' scale='.05 .04 .05' color='red'></a-cylinder>
      
      <a-entity id='p3nametext' position='0 -.255 .262' scale='.9 .9 .9' n-text='fontSize: 1; text: <color=black>Player3'></a-entity>
      <a-entity id='p3text' position='.01 -.51 .272' n-text='fontSize: 2; text: <color=black>3'></a-entity>
    </a-entity>
  </a-entity> -->
  
    <a-entity id='controls' position='-2 4.5 10' scale='1.2 1.2 1' rotation='0 0 0'>
      <a-box position='.15 .05 0' scale='.6 .4 .03' color='#555'></a-box>
      
      <a-entity position='-.04 .22 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: Move desk'></a-entity>
      <a-entity position='-.04 .16 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: Raise/Lower'></a-entity>
      
      <a-entity id='p1panelname' position='-.07 .03 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: 1'></a-entity>
      <a-entity id='p2panelname' position='-.07 -.03 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: 2'></a-entity>
      <a-entity id='p3panelname' position='-.07 -.09 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: 3'></a-entity>
      
      <a-entity id='p1paneltext' position='.12 .03 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: 1'></a-entity>
      <a-entity id='p2paneltext' position='.12 -.03 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: 2'></a-entity>
      <a-entity id='p3paneltext' position='.12 -.09 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: 3'></a-entity>
      
      <a-entity position='.27 .22 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: Move Backdrop'></a-entity>
      <a-entity position='.27 .16 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: Fade Backdrop'></a-entity>
      <a-entity position='.27 .1 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: Viv Podium'></a-entity>
      <a-entity position='.26 -.09 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: Reset Buzzers'></a-entity>
      <a-box id='moveBack' position='.4 .22 .01' scale='.05 .05 .03' color='blue'></a-box>
      <a-box id='darken' position='.4 .16 .01' scale='.05 .05 .03' color='blue'></a-box>
      <a-box id='miniP' position='.4 .1 .01' scale='.05 .05 .03' color='blue'></a-box>
      
      <a-entity position='.27 .04 .02' scale='.3 .3 .3' n-text='fontSize: 1; text: Laugh Button'></a-entity>
      <a-box id='laughBToggle' position='.4 .04 .01' scale='.05 .05 .03' color='blue'></a-box>
      
      <a-box id='movedesk' position='.07 .22 .01' scale='.05 .05 .03' color='blue'></a-box>
      <a-box id='raiselower' position='.07 .16 .01' scale='.05 .05 .03' color='blue'></a-box>
      <a-box id='resetb' position='.4 -.09 .01' scale='.05 .05 .03' color='#f00'></a-box>
      <a-box id='p1down' position='.01 .03 .01' scale='.05 .05 .03' color='#f00'></a-box>
      <a-box id='p1up' position='.07 .03 .01' scale='.05 .05 .03' color='#0f0'></a-box>
      <a-box id='p2down' position='.01 -.03 .01' scale='.05 .05 .03' color='#f00'></a-box>
      <a-box id='p2up' position='.07 -.03 .01' scale='.05 .05 .03' color='#0f0'></a-box>
      <a-box id='p3down' position='.01 -.09 .01' scale='.05 .05 .03' color='#f00'></a-box>
      <a-box id='p3up' position='.07 -.09 .01' scale='.05 .05 .03' color='#0f0'></a-box>
    </a-entity>
    
  
    <a-entity id='desk' position='0 0 1.5' rotation='0 -90 0'>
      <a-entity id=deskModel position='-2 0 0'>
        <a-plane position='.745 .54 0' scale='2.1 1.15 1' rotation='0 90 0' side='double' color='#002'></a-plane>
        <a-plane id='logoP' position='.75 .65 0' scale='1.5 .6 1' rotation='0 90 0' src='#logo' transparent='true'>
          <a-animation attribute='scale' to='.75 .6 1' dur='8000' begin='position2'></a-animation>
          <a-animation attribute='scale' from='.75 .6 1' to='1.5 .6 1' dur='8000' begin='position1'></a-animation>
        </a-plane>
        <a-cylinder position='.545 .54 -1.07' scale='.2 1.15 .2' color='#002'></a-cylinder>
        <a-entity position='0 0 0', scale='.01 .013 .01' rotation='0 0 0' obj-model='obj: url(https://bengarfield.github.io/AltVR/Hive/StandingDesk/desk.obj); mtl: url(https://bengarfield.github.io/AltVR/Hive/StandingDesk/blue.mtl)'></a-entity>
        
        <a-entity id='miniPodium' position='-.35 1.25 0' scale='.3 .3 .3' rotation='0 90 0'>
          <a-entity position='0 0 -1' rotation='0 0 0'>
            <a-entity position='0 -1.5 0' scale='.5 .5 .5' rotation='0 -90 0' obj-model='obj: url(https://bengarfield.github.io/AltVR/Hive/podium.obj); mtl: url(https://bengarfield.github.io/AltVR/Hive/podium.mtl)'></a-entity>
            <a-cylinder id='miniButton' position='0 -.26 0' scale='.05 .04 .05' color='red'></a-cylinder>
            <a-entity position='0 -.255 .262' scale='.9 .9 .9' n-text='fontSize: 1; text: <color=black>?'></a-entity>
            <a-entity position='.03 -.49 .272' rotation='0 0 90' n-text='fontSize: 2; text: <color=white>8'></a-entity>
            <!-- <a-entity position='.01 -.51 .272' n-text='fontSize: 2; text: <color=white>8'></a-entity> -->
          </a-entity>
          <a-animation attribute='position' to='-.35 1.62 0' dur='5000' begin='raise'></a-animation>
          <a-animation attribute='position' from='-.35 1.62 0' to='-.35 1.25 0' dur='5000' begin='lower'></a-animation>
          
          <a-animation attribute='scale' to='.15 .3 .18' dur='8000' begin='position2'></a-animation>
          <a-animation attribute='scale' from='.15 .3 .18' to='.3 .3 .3' dur='8000' begin='position1'></a-animation>
        </a-entity>
        
        <a-entity id='deskButtons' position='0 .1 0' rotation='0 0 0'>
          <a-cylinder id='correct' position='-.53 1.02 .15' scale='.05 .05 .05' color='green'></a-cylinder>
          <a-cylinder id='wrong' position='-.53 1.02 -.15' scale='.05 .05 .05' color='red'></a-cylinder>
          <a-animation attribute='position' to='0 .19 0' delay='4000' dur='1000' begin='raise'></a-animation>
          <a-animation attribute='position' from='0 .19 0' to='0 .1 0' dur='1000' begin='lower'></a-animation>
          
          <a-cylinder id='laughB' position='-.6 1.02 0' scale='.05 .05 .05' color='red'>
            <a-animation attribute='position' to='-.6 1.11 0' delay='0' dur='1000' begin='raiseLaugh'></a-animation>
            <a-animation attribute='position' from='-.6 1.11 0' to='-.53 1.02 0' dur='1000' begin='lowerLaugh'></a-animation>
          </a-cylinder>
        </a-entity>
        
        <!-- <a-animation attribute='position' to='-3 0 0' dur='8000' begin='position2'></a-animation>
        <a-animation attribute='position' from='-3 0 0' to='-2 0 0' dur='8000' begin='position1'></a-animation> -->
        
        <a-animation attribute='scale' to='1.7 1 2' dur='8000' begin='position2'></a-animation>
        <a-animation attribute='scale' from='1.7 1 2' to='1 1 1' dur='8000' begin='position1'></a-animation>
      </a-entity>
      <a-animation attribute='position' to='0 0 2' dur='8000' begin='position2'></a-animation>
      <a-animation attribute='position' from='0 0 2' to='0 0 1.5' dur='8000' begin='position1'></a-animation>
      
      <a-animation attribute='rotation' to='0 -120 0' dur='8000' begin='position21'></a-animation>
      <a-animation attribute='rotation' from='0 -120 0' to='0 -90 0' dur='8000' begin='position11'></a-animation>
      <!-- <a-circle position='0 .5 0' rotation='-90 0 0' opacity='.1' radius='3' altspace-cursor-collider='enabled: false'></a-circle> -->
    </a-entity>
    
</a-scene>
<script>
  sound.setAttribute('n-sound', {src: /Mobile/i.test(navigator.userAgent) ? 'https://bengarfield.github.io/AltVR/Hive/sounds/ding.mp3' : 'https://bengarfield.github.io/AltVR/Hive/sounds/ding.ogg', volume: 0.3, spatialBlend: 0.5});
  sound2.setAttribute('n-sound', {src: /Mobile/i.test(navigator.userAgent) ? 'https://bengarfield.github.io/AltVR/codenames/sounds/fail.mp3' : 'https://bengarfield.github.io/AltVR/codenames/sounds/fail.ogg', volume: 0.1, spatialBlend: 0.5});
  sound3.setAttribute('n-sound', {src: /Mobile/i.test(navigator.userAgent) ? 'https://bengarfield.github.io/AltVR/Hive/sounds/yay.mp3' : 'https://bengarfield.github.io/AltVR/Hive/sounds/yay.ogg', volume: 0.3, spatialBlend: 0.5});
  syncDing.setAttribute('n-sound', {src: /Mobile/i.test(navigator.userAgent) ? 'https://bengarfield.github.io/AltVR/Hive/sounds/ding.mp3' : 'https://bengarfield.github.io/AltVR/Hive/sounds/ding.ogg', volume: 0.3, spatialBlend: 0.5, pitch: 2});
  syncLaugh.setAttribute('n-sound', {src: /Mobile/i.test(navigator.userAgent) ? 'https://bengarfield.github.io/AltVR/Hive/sounds/laugh.mp3' : 'https://bengarfield.github.io/AltVR/Hive/sounds/laugh.ogg', volume: 0.3, spatialBlend: 0.5});
  
  //deskModel.children[2].object3D.children[1].children[0].material.color = new THREE.Color(0,0,1);
  
  var scene = document.querySelector('a-scene');
    
  scene.addEventListener('connected', function() {
    var sync = scene.systems['sync-system'].connection;
    /*var done = false;
    
    var gold = new THREE.Color(.698039,.623529,.109803);
    var red = new THREE.Color(1,0,0);
    var green = new THREE.Color(0,.5,0);
    
    sync.instance.child('click').on('value', function(data){
      if (data.val() == null) {
        //panel1.setAttribute('color', '#B29F1C');
        //panel2.setAttribute('color', '#B29F1C');
        //panel3.setAttribute('color', '#B29F1C');
        podiumobj1.object3D.children[0].children[8].material.color = gold;
        podiumobj2.object3D.children[0].children[8].material.color = gold;
        podiumobj3.object3D.children[0].children[8].material.color = gold;
        
        button1.setAttribute('color', 'red');
        button2.setAttribute('color', 'red');
        button3.setAttribute('color', 'red');
        done = false;
      } else {
        var i = data.val()[Object.keys(data.val())[0]];
        //console.log(i);
        //panel1.setAttribute('color', 'red');
        //panel2.setAttribute('color', 'red');
        //panel3.setAttribute('color', 'red');
        
        podiumobj1.object3D.children[0].children[8].material.color = red;
        podiumobj2.object3D.children[0].children[8].material.color = red;
        podiumobj3.object3D.children[0].children[8].material.color = red;
        
        document.querySelector('#podiumobj' + i).object3D.children[0].children[8].material.color = green;
        document.querySelector('#button' + i).setAttribute('color', 'green');
        
        if (!done) {
          sound.components['n-sound'].playSound();
          done = true;
        }
      }
    });
    
    var p1score = 0;
    var p2score = 0;
    var p3score = 0;
    
    sync.instance.child('score').on('value', function(data){
      if (data.val() != null) {
        p1score = data.val()['p1'];
        p2score = data.val()['p2'];
        p3score = data.val()['p3'];
        p1text.setAttribute('n-text', 'text', p1score);
        p2text.setAttribute('n-text', 'text', p2score);
        p3text.setAttribute('n-text', 'text', p3score);
        
        p1paneltext.setAttribute('n-text', 'text', p1score);
        p2paneltext.setAttribute('n-text', 'text', p2score);
        p3paneltext.setAttribute('n-text', 'text', p3score);
      } else {
        sync.instance.child('score').set({p1:0, p2:0, p3:0});
      }
    });
    
    var p1name;
    var p2name;
    var p3name;
    
    sync.instance.child('names').on('value', function(data){
      if (data.val() != null) {
        p1name = data.val()['p1'];
        p2name = data.val()['p2'];
        p3name = data.val()['p3'];
        p1nametext.setAttribute('n-text', 'text', '<color=black>' + p1name);
        p2nametext.setAttribute('n-text', 'text', '<color=black>' + p2name);
        p3nametext.setAttribute('n-text', 'text', '<color=black>' + p3name);
        
        p1panelname.setAttribute('n-text', 'text', p1name);
        p2panelname.setAttribute('n-text', 'text', p2name);
        p3panelname.setAttribute('n-text', 'text', p3name);
      } else {
        sync.instance.child('names').set({p1:'Player1', p2:'Player2', p3:'Player3'});
      }
    });*/
    
    var deskPosition;
    sync.instance.child('deskPosition').on('value', function(data){
      if (data.val() != null) {
        if (data.val() == '2') {
          if (deskPosition == undefined) {
            miniPodium.setAttribute('scale', '.15 .3 .18');
            desk.setAttribute('position', '0 0 2');
            logoP.setAttribute('scale', '.75 .6 1');
            deskModel.setAttribute('scale', '1.7 1 2');
          } else {
            miniPodium.emit('position2');
            desk.emit('position2');
            logoP.emit('position2');
            deskModel.emit('position2');
          }
          movedesk.setAttribute('color', '#0f0');
        } else if (deskPosition != null) {
          miniPodium.emit('position1');
          desk.emit('position1');
          logoP.emit('position1');
          deskModel.emit('position1');
          movedesk.setAttribute('color', 'blue');
        }
        deskPosition = data.val();
      } else {
        sync.instance.child('deskPosition').set('1');
      }
    });
    
    /*var podiumState;
    sync.instance.child('podiumState').on('value', function(data){
      if (data.val() != null) {
        if (data.val() == 'raised') {
          if (podiumState == undefined) {
            podiums.setAttribute('position', '-2.5 1.5 -1.5');
            deskButtons.setAttribute('position', '0 .19 0');
          } else {
            podiums.emit('raise');
            deskButtons.emit('raise');
          }
          raiselower.setAttribute('color', '#0f0');
        } else if (podiumState != null) {
          podiums.emit('lower');
          deskButtons.emit('lower');
          raiselower.setAttribute('color', 'blue');
        }
        podiumState = data.val();
      } else {
        sync.instance.child('podiumState').set('lowered');
      }
    });*/

    
    var miniPodiumState;
    sync.instance.child('miniPodiumState').on('value', function(data){
      if (data.val() != null) {
        if (data.val() == 'raised') {
          if (miniPodiumState == undefined) {
            miniPodium.setAttribute('position', '-.35 1.62 0');
          } else {
            miniPodium.emit('raise');
          }
          miniP.setAttribute('color', '#0f0');
        } else if (miniPodiumState != null) {
          miniPodium.emit('lower');
          miniP.setAttribute('color', 'blue');
        }
        miniPodiumState = data.val();
      } else {
        sync.instance.child('miniPodiumState').set('lowered');
      }
    });
    
    var backdropState;
    sync.instance.child('backdrop').on('value', function(data){
      if (data.val() != null) {
        if (data.val() == 'dark') {
          if (backdropState == undefined) {
            backdrop.setAttribute('color', '#777');
          } else {
            backdrop.emit('darken');
          }
          darken.setAttribute('color', '#0f0');
        } else if (backdropState != null) {
          backdrop.emit('lighten');
          darken.setAttribute('color', 'blue');
        }
        backdropState = data.val();
      } else {
        sync.instance.child('backdrop').set('light');
      }
    });
    
    var backdropState2;
    sync.instance.child('backdropPos').on('value', function(data){
      if (data.val() != null) {
        if (data.val() == 'off') {
          if (backdropState2 == undefined) {
            bdropPos.setAttribute('rotation', '0 -60 0');
          } else {
            bdropPos.emit('off');
          }
          moveBack.setAttribute('color', '#0f0');
        } else if (backdropState2 != null) {
          bdropPos.emit('on');
          moveBack.setAttribute('color', 'blue');
        }
        backdropState2 = data.val();
      } else {
        sync.instance.child('backdropPos').set('on');
      }
    });
    
    var laughBState;
    sync.instance.child('laughButtonState').on('value', function(data){
      if (data.val() != null) {
        if (data.val() == 'raised') {
          if (laughBState == undefined) {
            laughB.setAttribute('position', '-.6 1.11 0');
          } else {
            laughB.emit('raiseLaugh');
          }
          laughBToggle.setAttribute('color', '#0f0');
        } else if (laughBState != null) {
          laughB.emit('lowerLaugh');
          laughBToggle.setAttribute('color', 'blue');
        }
        laughBState = data.val();
      } else {
        sync.instance.child('laughButtonState').set('lowered');
      }
    });
    
    altspace.getUser().then(function(user){
      if (user.isModerator) {
        
        rant.setAttribute('position', '8 0 -3')
        
        //scene.systems['sync-system'].instantiate('hexBadge', scene);
        
        /*resetb.addEventListener('mousedown', function(){
          sync.instance.child('click').set(null);
        });
        p1up.addEventListener('mousedown', function(){
          sync.instance.child('score').child('p1').set(p1score + 1);
        });
        p1down.addEventListener('mousedown', function(){
          sync.instance.child('score').child('p1').set(p1score - 1);
        });
        p2up.addEventListener('mousedown', function(){
          sync.instance.child('score').child('p2').set(p2score + 1);
        });
        p2down.addEventListener('mousedown', function(){
          sync.instance.child('score').child('p2').set(p2score - 1);
        });
        p3up.addEventListener('mousedown', function(){
          sync.instance.child('score').child('p3').set(p3score + 1);
        });
        p3down.addEventListener('mousedown', function(){
          sync.instance.child('score').child('p3').set(p3score - 1);
        });*/
        
        movedesk.addEventListener('mousedown', function(){
          if (deskPosition == '1') {
            sync.instance.child('deskPosition').set('2');
          } else {
            sync.instance.child('deskPosition').set('1');
          }
        });
        
        /*raiselower.addEventListener('mousedown', function(){
          if (podiumState == 'lowered') {
            sync.instance.child('podiumState').set('raised');
          } else {
            sync.instance.child('podiumState').set('lowered');
          }
        });*/
        
        miniP.addEventListener('mousedown', function(){
          if (miniPodiumState == 'lowered') {
            sync.instance.child('miniPodiumState').set('raised');
          } else {
            sync.instance.child('miniPodiumState').set('lowered');
          }
        });
        
        laughBToggle.addEventListener('mousedown', function(){
          if (laughBState == 'lowered') {
            sync.instance.child('laughButtonState').set('raised');
          } else {
            sync.instance.child('laughButtonState').set('lowered');
          }
        });
        
        laughB.addEventListener('mousedown', function(){
          if (laughBState == 'raised') {
            syncLaugh.components.sync.takeOwnership();
            syncLaugh.components['n-sound'].playSound();
          }
        });
        laughB.object3D.children[0].addBehavior(new altspace.utilities.behaviors.JointCollisionEvents({
          joints: [['Index','Right',3],['Index','Left',3]],
          jointCubeSize: .05
        }));
        laughB.object3D.children[0].addEventListener('jointcollisionenter', function(e){
          if (laughBState == 'raised') {
            syncLaugh.components.sync.takeOwnership();
            syncLaugh.components['n-sound'].playSound();
          }
        });
        
        /*wrong.addEventListener('mousedown', function(){
          if (podiumState == 'raised') {
            sound2.components.sync.takeOwnership();
            sound2.components['n-sound'].playSound();
          }
        });
        wrong.object3D.children[0].addBehavior(new altspace.utilities.behaviors.JointCollisionEvents({
          joints: [['Index','Right',3],['Index','Left',3]],
          jointCubeSize: .05
        }));
        wrong.object3D.children[0].addEventListener('jointcollisionenter', function(e){
          if (podiumState == 'raised') {
            sound2.components.sync.takeOwnership();
            sound2.components['n-sound'].playSound();
          }
        });
        
        correct.addEventListener('mousedown', function(){
          if (podiumState == 'raised') {
            sound3.components.sync.takeOwnership();
            sound3.components['n-sound'].playSound();
          }
        });
        correct.object3D.children[0].addBehavior(new altspace.utilities.behaviors.JointCollisionEvents({
          joints: [['Index','Right',3],['Index','Left',3]],
          jointCubeSize: .05
        }));
        correct.object3D.children[0].addEventListener('jointcollisionenter', function(e){
          if (podiumState == 'raised') {
            sound3.components.sync.takeOwnership();
            sound3.components['n-sound'].playSound();
          }
        });*/
        
        miniButton.object3D.children[0].addBehavior(new altspace.utilities.behaviors.JointCollisionEvents({
          joints: [['Index','Right',3],['Index','Left',3]],
          jointCubeSize: .1
        }));
        miniButton.object3D.children[0].addEventListener('jointcollisionenter', function(e){
          if (miniPodiumState == 'raised') {
            syncDing.components.sync.takeOwnership();
            syncDing.components['n-sound'].playSound();
          }
        });
        
        /*darken.addEventListener('mousedown', function(){
          if (backdropState == 'dark') {
            sync.instance.child('backdrop').set('light');
          } else {
            sync.instance.child('backdrop').set('dark');
          }
        });
        
        moveBack.addEventListener('mousedown', function(){
          if (backdropState2 == 'off') {
            sync.instance.child('backdropPos').set('on');
          } else {
            sync.instance.child('backdropPos').set('off');
          }
        });*/
      }
      
      /*button1.addEventListener('mousedown', function(){
        if (user.displayName == p1name) {
          sync.instance.child('click').push('1');
        }
      });

      button2.addEventListener('mousedown', function(){
        if (user.displayName == p2name) {
          sync.instance.child('click').push('2');
        }
      });

      button3.addEventListener('mousedown', function(){
        if (user.displayName == p3name) {
          sync.instance.child('click').push('3');
        }
      });
      
      button1.object3D.children[0].addBehavior(new altspace.utilities.behaviors.JointCollisionEvents({
        joints: [['Index','Right',3],['Index','Left',3]],
        jointCubeSize: .1
      }));
      button1.object3D.children[0].addEventListener('jointcollisionenter', function(e){
        if (user.displayName == p1name) {
          sync.instance.child('click').push('1');
        }
      });
      button2.object3D.children[0].addBehavior(new altspace.utilities.behaviors.JointCollisionEvents({
        joints: [['Index','Right',3],['Index','Left',3]],
        jointCubeSize: .1
      }));
      button2.object3D.children[0].addEventListener('jointcollisionenter', function(e){
        if (user.displayName == p2name) {
          sync.instance.child('click').push('2');
        }
      });
      button3.object3D.children[0].addBehavior(new altspace.utilities.behaviors.JointCollisionEvents({
        joints: [['Index','Right',3],['Index','Left',3]],
        jointCubeSize: .1
      }));
      button3.object3D.children[0].addEventListener('jointcollisionenter', function(e){
        if (user.displayName == p3name) {
          sync.instance.child('click').push('3');
        }
      });*/
    });
    
  });
</script>
</body>
</html>